---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('posts');
const sortedPosts = posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout title="Sho Kuno" description="Personal blog about technology, research, and thoughts">
  <div class="max-w-[672px] mx-auto px-4 py-8">
    <div class="space-y-12">
      {sortedPosts.map(async (post) => {
        const { Content } = await post.render();
        return (
          <article class="prose prose-gray max-w-none">
            <header class="mb-6">
              <h1 class="text-2xl font-bold mb-2">
                <a href={`/posts/${post.slug}/`} class="text-gray-900 hover:text-[#007aff] transition-colors no-underline">
                  {post.data.title}
                </a>
              </h1>
              <time class="text-sm text-gray-600">
                {post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
              {post.data.tags && post.data.tags.length > 0 && (
                <div class="mt-2 flex flex-wrap gap-2">
                  {post.data.tags.map((tag) => (
                    <a 
                      href={`/posts/tags/#tag-${tag.toLowerCase().replace(/\s+/g, '-')}`}
                      class="text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors no-underline"
                    >
                      {tag}
                    </a>
                  ))}
                </div>
              )}
            </header>
            <div class="prose-a:text-[#007aff] prose-a:no-underline hover:prose-a:underline">
              <Content />
            </div>
          </article>
        );
      })}
    </div>
  </div>
</Layout>

<style>
  article {
    @apply border-b border-gray-200 pb-12 last:border-b-0;
  }
  
  :global(.prose h1) {
    @apply text-2xl;
  }
  
  :global(.prose h2) {
    @apply text-xl;
  }
  
  :global(.prose h3) {
    @apply text-lg;
  }
  
  :global(.prose pre) {
    @apply bg-gray-50 rounded-lg p-4 overflow-x-auto;
  }
  
  :global(.prose code) {
    @apply bg-gray-100 px-1 py-0.5 rounded text-sm;
  }
  
  :global(.prose pre code) {
    @apply bg-transparent p-0;
  }
</style>